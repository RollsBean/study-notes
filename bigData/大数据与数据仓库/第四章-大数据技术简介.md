### 大数据技术简介

#### 引言

大数据相关技术介绍。

#### 分布式数据处理

关系型数据库使用分布式处理架构的问题:
1. 对RDBMS的依赖
事务管理ACID
一致性管理
系统延迟
网络较慢
数据库I/O
2. SAN架构
3. 基础设施成本
4. 复杂的数据处理和转换要求
5. 最小容错能力与昂贵的容错解决方案

NoSQL等分布式数据库基本原则：
1. 最大程度的并行处理
2. 最小的数据库使用
3. 基于分布式文件的存储
4. 线性可扩展的基础设施
5. 高速复制
6. 高可用
7. 容错能力
8. 本地化数据处理和结果存储，计算和存储在同一磁盘

#### 大数据处理需求

1. 数据量：数据量很大，需要跨系统并行处理，并且需要一次性处理完成
2. 速度
3. 多样性：不同格式、类型、结构和区域

#### 大数据处理技术

Google文件系统：GFS

架构图：![GFS 架构图](/image/bigData-GFS%20架构.png)

GFS集群：
单个主节点
每个节点对应多个块服务器
支持多客户端访问

文件：
用固定大小的数据块（64Mb）表示
用64位唯一id标记
存储在块服务器且有三个服务器镜像

主节点的作用是与客户端通信，告诉客户端块数据位置以及元数据信息，客户端之后会直接与块服务器交互，因此主节点不会成为瓶颈。为了避免主节点和所以的
元数据单点故障，出于速度考虑，GFS在内存中保存数据，在本地磁盘保存日志，在远程节点复制磁盘。

#### Hadoop

Hadoop第一代包括HDFS、MapReduce框架以及接口

Hadoop相关的开源项目：
Avro - 数据序列化系统
Cassandra - 可扩展多主节点数据库
Chukwa - 管理大型分布式系统的数据采集系统
HBase - 支持存储大型表的结构化数据存储，可扩展分布式数据库
Hive - 数据仓库
Mahout - 可扩展的机器学习和数据挖掘库
Pig - 并行计算的高级数据流语言和执行框架
Zookeeper - 用于分布式应用的高性能协调服务

**Hadoop核心组件**

1. HDFS

HDFS是一个高容错、可扩展的分布式文件系统

**命名节点：** 命名节点是单个主服务器，它管理文件系统命名空间以及控制客户端对文件的访问，管理块到数据节点的映射。
**数据节点：** 从节点，保存数据，可以并发执行多个任务
**心跳线：** 命名节点和数据节点通过每三秒发送的心跳线管理。心跳线包含存储容量、使用中的存储以及数据传输次数，这些数据由命名节点统计用来管理空间分配和负载均衡

十分钟没有收到心跳线，命名空间就会任务数据节点停止服务。

**MapReduce:** 处理大数据集的编程模型，基于函数编程模型，框架包括不同的接口库，映射器、归约器、报告器、合并器、分区器等。

Map: 输入的键值对到计算后产生的中间键值对集合
Reduce: 接受中间键机器对应值的集合，处理值集合

问题：1.可扩展性，2.单点故障

**MapReduce v2(YARN)**

主要组件：
1. 资源管理器ResourceManager(RM)
调度器：负责资源分配，进度管理
应用管理器：接受作业提交，失败时重启AM容器

2. 节点管理器

负责启动应用容器，设置任务执行环境，管理本地存储

3. 应用主节点ApplicationMaster(AM)

与RM协商资源，管理任务执行，恢复失败的应用

#### Zookeeper

Zookeeper是开源的、基于内存的、分布式的NoSQL数据库，用于管理分布式应用的协调服务。
Zookeeper架构基于一个称为zNode的层次命名空间结构，
Zookeeper主要为了储存协调数据：状态信息、配置、位置信息等，数据量不大

**Zookeeper提供数据一致性模型**
1. 顺序一致性
2. 原子性
3. 单一系统映像
4. 持久性
5. 及时性

应用于：
1. 配置服务 - 配置更新和发生变化提醒
2. 锁 - 互斥锁
3. 领导者选举 - 仅有一个
4. 组成员身份
5. 队列生产者/消费者范式

**运行模式**
1. 单机 - 独立模式
2. 复制模式 - 集群， 部署奇数台

使用Zab两阶段协议来确保分布式一致性，

